import{aa as ve,R as be,Q as ye,b as R,U,r as P,c as E,a as j,P as ee,_ as G,d as S,m as x,o as g,j as B,n as N,h as t,b7 as he,az as ge,H as q,b8 as we,g as k,q as b,p as A,t as F,w as C,e as K,l as Ie,E as Ce,af as xe,ag as Ne,f as H,v as ke,b9 as Ee,y as te,a9 as se,ba as Se,D as L,bb as M,ab as We,F as T,aD as D,ad as $e,u as Te,i as ne,bc as Ke,aL as V,aK as Q}from"./index-V5D2x0Ut.js";import{a as Ae,n as J,E as De,l as le,m as ae,f as Y,g as Pe,j as ze,h as Be}from"./EditStore-DSPXieUz.js";import{C as oe,U as re,j as ie,k as ce}from"./drawer-lkajH2Kw.js";import{c as Ve,E as Fe}from"./index-Dolo2fDS.js";import{_ as Me}from"./WavesBar-C2WLY_fZ.js";const Z=m=>ve(m)||be(m)||ye(m),Oe=R({accordion:Boolean,modelValue:{type:U([Array,String,Number]),default:()=>{}},expandIconPosition:{type:U([String]),default:"right"}}),Re={[re]:Z,[oe]:Z},de=Symbol("collapseContextKey"),je=(m,e)=>{const i=P([]),d=E(()=>{var p;const f=(p=m.modelValue)!=null?p:i.value;return Ve(f)}),o=p=>{i.value=p;const f=m.accordion?i.value[0]:i.value;e(re,f),e(oe,f)};return ee(de,{activeNames:d,handleItemClick:p=>{if(m.accordion)o([d.value[0]===p?"":p]);else{const f=[...d.value],s=f.indexOf(p);s>-1?f.splice(s,1):f.push(p),o(f)}}}),{activeNames:d,setActiveNames:o}},He=m=>{const e=j("collapse");return{rootKls:E(()=>[e.b(),e.b(`icon-position-${m.expandIconPosition}`)])}},Ue=S({name:"ElCollapse"}),Ge=S({...Ue,props:Oe,emits:Re,setup(m,{expose:e,emit:i}){const d=m,{activeNames:o,setActiveNames:r}=je(d,i),{rootKls:p}=He(d);return e({activeNames:o,setActiveNames:r}),(f,s)=>(g(),x("div",{class:N(t(p))},[B(f.$slots,"default")],2))}});var Le=G(Ge,[["__file","collapse.vue"]]);const qe=R({title:{type:String,default:""},name:{type:U([String,Number]),default:void 0},icon:{type:ge,default:he},disabled:Boolean}),Qe=m=>{const e=q(de),{namespace:i}=j("collapse"),d=P(!1),o=P(!1),r=we(),p=E(()=>r.current++),f=E(()=>{var I;return(I=m.name)!=null?I:`${i.value}-id-${r.prefix}-${t(p)}`}),s=E(()=>e==null?void 0:e.activeNames.value.includes(t(f)));return{focusing:d,id:p,isActive:s,handleFocus:()=>{setTimeout(()=>{o.value?o.value=!1:d.value=!0},50)},handleHeaderClick:()=>{m.disabled||(e==null||e.handleItemClick(t(f)),d.value=!1,o.value=!0)},handleEnterClick:()=>{e==null||e.handleItemClick(t(f))}}},Je=(m,{focusing:e,isActive:i,id:d})=>{const o=j("collapse"),r=E(()=>[o.b("item"),o.is("active",t(i)),o.is("disabled",m.disabled)]),p=E(()=>[o.be("item","header"),o.is("active",t(i)),{focusing:t(e)&&!m.disabled}]),f=E(()=>[o.be("item","arrow"),o.is("active",t(i))]),s=E(()=>[o.be("item","title")]),c=E(()=>o.be("item","wrap")),_=E(()=>o.be("item","content")),v=E(()=>o.b(`content-${t(d)}`)),I=E(()=>o.b(`head-${t(d)}`));return{itemTitleKls:s,arrowKls:f,headKls:p,rootKls:r,itemWrapperKls:c,itemContentKls:_,scopedContentId:v,scopedHeadId:I}},Xe=S({name:"ElCollapseItem"}),Ye=S({...Xe,props:qe,setup(m,{expose:e}){const i=m,{focusing:d,id:o,isActive:r,handleFocus:p,handleHeaderClick:f,handleEnterClick:s}=Qe(i),{arrowKls:c,headKls:_,rootKls:v,itemTitleKls:I,itemWrapperKls:w,itemContentKls:l,scopedContentId:a,scopedHeadId:n}=Je(i,{focusing:d,isActive:r,id:o});return e({isActive:r}),(u,y)=>(g(),x("div",{class:N(t(v))},[k("button",{id:t(n),class:N(t(_)),"aria-expanded":t(r),"aria-controls":t(a),"aria-describedby":t(a),tabindex:u.disabled?-1:0,type:"button",onClick:t(f),onKeydown:xe(Ne(t(s),["stop","prevent"]),["space","enter"]),onFocus:t(p),onBlur:h=>d.value=!1},[k("span",{class:N(t(I))},[B(u.$slots,"title",{isActive:t(r)},()=>[A(F(u.title),1)])],2),B(u.$slots,"icon",{isActive:t(r)},()=>[b(t(Ce),{class:N(t(c))},{default:C(()=>[(g(),K(Ie(u.icon)))]),_:1},8,["class"])])],42,["id","aria-expanded","aria-controls","aria-describedby","tabindex","onClick","onKeydown","onFocus","onBlur"]),b(t(Ee),null,{default:C(()=>[H(k("div",{id:t(a),role:"region",class:N(t(w)),"aria-hidden":!t(r),"aria-labelledby":t(n)},[k("div",{class:N(t(l))},[B(u.$slots,"default")],2)],10,["id","aria-hidden","aria-labelledby"]),[[ke,t(r)]])]),_:3})],2))}});var ue=G(Ye,[["__file","collapse-item.vue"]]);const pe=te(Le,{CollapseItem:ue}),me=se(ue),X=Symbol("elDescriptions");var O=S({name:"ElDescriptionsCell",props:{cell:{type:Object},tag:{type:String,default:"td"},type:{type:String}},setup(){return{descriptions:q(X,{})}},render(){var m;const e=Se(this.cell),i=(((m=this.cell)==null?void 0:m.dirs)||[]).map(u=>{const{dir:y,arg:h,modifiers:W,value:$}=u;return[y,$,h,W]}),{border:d,direction:o}=this.descriptions,r=o==="vertical",p=()=>{var u,y,h;return((h=(y=(u=this.cell)==null?void 0:u.children)==null?void 0:y.label)==null?void 0:h.call(y))||e.label},f=()=>{var u,y,h;return(h=(y=(u=this.cell)==null?void 0:u.children)==null?void 0:y.default)==null?void 0:h.call(y)},s=e.span,c=e.rowspan,_=e.align?`is-${e.align}`:"",v=e.labelAlign?`is-${e.labelAlign}`:_,I=e.className,w=e.labelClassName,l=this.type==="label"&&(e.labelWidth||this.descriptions.labelWidth)||e.width,a={width:L(l),minWidth:L(e.minWidth)},n=j("descriptions");switch(this.type){case"label":return H(M(this.tag,{style:a,class:[n.e("cell"),n.e("label"),n.is("bordered-label",d),n.is("vertical-label",r),v,w],colSpan:r?s:1,rowspan:r?1:c},p()),i);case"content":return H(M(this.tag,{style:a,class:[n.e("cell"),n.e("content"),n.is("bordered-content",d),n.is("vertical-content",r),_,I],colSpan:r?s:s*2-1,rowspan:r?c*2-1:c},f()),i);default:{const u=p(),y={},h=L(e.labelWidth||this.descriptions.labelWidth);return h&&(y.width=h,y.display="inline-block"),H(M("td",{style:a,class:[n.e("cell"),_],colSpan:s,rowspan:c},[We(u)?void 0:M("span",{style:y,class:[n.e("label"),w]},u),M("span",{class:[n.e("content"),I]},f())]),i)}}}});const Ze=R({row:{type:U(Array),default:()=>[]}}),et=S({name:"ElDescriptionsRow"}),tt=S({...et,props:Ze,setup(m){const e=q(X,{});return(i,d)=>t(e).direction==="vertical"?(g(),x(T,{key:0},[k("tr",null,[(g(!0),x(T,null,D(i.row,(o,r)=>(g(),K(t(O),{key:`tr1-${r}`,cell:o,tag:"th",type:"label"},null,8,["cell"]))),128))]),k("tr",null,[(g(!0),x(T,null,D(i.row,(o,r)=>(g(),K(t(O),{key:`tr2-${r}`,cell:o,tag:"td",type:"content"},null,8,["cell"]))),128))])],64)):(g(),x("tr",{key:1},[(g(!0),x(T,null,D(i.row,(o,r)=>(g(),x(T,{key:`tr3-${r}`},[t(e).border?(g(),x(T,{key:0},[b(t(O),{cell:o,tag:"td",type:"label"},null,8,["cell"]),b(t(O),{cell:o,tag:"td",type:"content"},null,8,["cell"])],64)):(g(),K(t(O),{key:1,cell:o,tag:"td",type:"both"},null,8,["cell"]))],64))),128))]))}});var st=G(tt,[["__file","descriptions-row.vue"]]);const nt=R({border:Boolean,column:{type:Number,default:3},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},size:$e,title:{type:String,default:""},extra:{type:String,default:""},labelWidth:{type:[String,Number],default:""}}),fe="ElDescriptionsItem",lt=S({name:"ElDescriptions"}),at=S({...lt,props:nt,setup(m){const e=m,i=j("descriptions"),d=Ae(),o=Te();ee(X,e);const r=E(()=>[i.b(),i.m(d.value)]),p=(s,c,_,v=!1)=>(s.props||(s.props={}),c>_&&(s.props.span=_),v&&(s.props.span=c),s),f=()=>{if(!o.default)return[];const s=Ke(o.default()).filter(l=>{var a;return((a=l==null?void 0:l.type)==null?void 0:a.name)===fe}),c=[];let _=[],v=e.column,I=0;const w=[];return s.forEach((l,a)=>{var n,u,y;const h=((n=l.props)==null?void 0:n.span)||1,W=((u=l.props)==null?void 0:u.rowspan)||1,$=c.length;if(w[$]||(w[$]=0),W>1)for(let z=1;z<W;z++)w[y=$+z]||(w[y]=0),w[$+z]++,I++;if(w[$]>0&&(v-=w[$],w[$]=0),a<s.length-1&&(I+=h>v?v:h),a===s.length-1){const z=e.column-I%e.column;_.push(p(l,z,v,!0)),c.push(_);return}h<v?(v-=h,_.push(l)):(_.push(p(l,h,v)),c.push(_),v=e.column,_=[])}),c};return(s,c)=>(g(),x("div",{class:N(t(r))},[s.title||s.extra||s.$slots.title||s.$slots.extra?(g(),x("div",{key:0,class:N(t(i).e("header"))},[k("div",{class:N(t(i).e("title"))},[B(s.$slots,"title",{},()=>[A(F(s.title),1)])],2),k("div",{class:N(t(i).e("extra"))},[B(s.$slots,"extra",{},()=>[A(F(s.extra),1)])],2)],2)):ne("v-if",!0),k("div",{class:N(t(i).e("body"))},[k("table",{class:N([t(i).e("table"),t(i).is("bordered",s.border)])},[k("tbody",null,[(g(!0),x(T,null,D(f(),(_,v)=>(g(),K(st,{key:v,row:_},null,8,["row"]))),128))])],2)],2)],2))}});var ot=G(at,[["__file","description.vue"]]);const rt=R({label:{type:String,default:""},span:{type:Number,default:1},rowspan:{type:Number,default:1},width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},labelWidth:{type:[String,Number],default:""},align:{type:String,default:"left"},labelAlign:{type:String,default:""},className:{type:String,default:""},labelClassName:{type:String,default:""}}),_e=S({name:fe,props:rt}),it=te(ot,{DescriptionsItem:_e}),ct=se(_e),dt={style:{"font-size":"16px","font-weight":"bold"}},ut={style:{display:"flex","flex-direction":"row","align-items":"flex-start"}},pt=S({__name:"TeamsPreview",props:{selectedWaveIndex:Number},setup(m){const e=J(),i=P("default"),d=m,{teams:o}=V(e),r=P(["红队","黄队","绿队"]);function p(s){return s===0?"bg-red":s===1?"bg-yellow":s===2?"bg-green":""}function f({row:s}){return s.ifsup===1?"row-support":s.ifsup===0?"row-carry":""}return(s,c)=>{const _=ce,v=ie,I=me,w=pe,l=De,a=ct,n=it;return g(),K(n,{title:d.selectedWaveIndex===-1?"未选择波次":"第"+(1+d.selectedWaveIndex)+"波",direction:"vertical",column:4,size:i.value,border:""},{default:C(()=>[b(a,{label:"队伍信息"},{default:C(()=>[b(w,{modelValue:r.value,"onUpdate:modelValue":c[0]||(c[0]=u=>r.value=u)},{default:C(()=>[(g(),x(T,null,D(["红队","黄队","绿队"],(u,y)=>b(I,{key:y,name:u},{title:C(()=>[k("div",{class:N(p(y))},[k("span",dt,F(u),1)],2)]),default:C(()=>{var h;return[b(v,{data:(h=t(o)[d.selectedWaveIndex])==null?void 0:h.color[y],style:{width:"100%"},size:"small",border:"","row-class-name":f},{default:C(()=>[b(_,{prop:"id",label:"ID"}),b(_,{prop:"fame",label:"名望"}),b(_,{prop:"profession",label:"职业"})]),_:2},1032,["data"])]}),_:2},1032,["name"])),64))]),_:1},8,["modelValue"]),k("div",ut,[b(l,{type:"danger",class:"redteam",style:{width:"45px"},onClick:c[1]||(c[1]=u=>t(e).resetTeams(d.selectedWaveIndex,0))},{default:C(()=>c[4]||(c[4]=[A("清空红队")])),_:1,__:[4]}),b(l,{type:"warning",class:"yellowteam",style:{width:"45px"},onClick:c[2]||(c[2]=u=>t(e).resetTeams(d.selectedWaveIndex,1))},{default:C(()=>c[5]||(c[5]=[A("清空黄队")])),_:1,__:[5]}),b(l,{type:"success",class:"greenteam",style:{width:"45px"},onClick:c[3]||(c[3]=u=>t(e).resetTeams(d.selectedWaveIndex,2))},{default:C(()=>c[6]||(c[6]=[A("清空绿队")])),_:1,__:[6]})])]),_:1})]),_:1},8,["title","size"])}}}),mt=Q(pt,[["__scopeId","data-v-0c1697f2"]]),ft=S({__name:"FilteredChars",props:{selectedWaveIndex:{},playerId:{}},setup(m){const e=J(),i=le();ae();const{teams:d}=V(e),{table:o}=V(i),r=m;function p(l,a,n){return typeof n=="number"?Math.floor(n):n}function f(l,a,n){return n===-1?"赋闲":n+1}function s(l,a){const n=r.selectedWaveIndex;if(n===-1){Y({message:"请选择波次",type:"error",duration:2e3});return}l.teamIndex===a?(d.value[l.waveIndex].color[l.teamIndex]=d.value[l.waveIndex].color[l.teamIndex].filter(u=>u.uid!==l.uid),l.teamIndex=-1,l.waveIndex=-1,Y.warning("安排取消")):l.teamIndex!==a&&e.tryAssignChar(l,n,a)}function c(l){switch(l){case 0:return"红队";case 1:return"黄队";case 2:return"绿队";default:return""}}function _(l){switch(l){case 0:return"red-tag";case 1:return"yellow-tag";case 2:return"green-tag";default:return""}}function v(l){const a=r.selectedWaveIndex;return a===-1?[]:o.value.filter(n=>n.id===l).sort((n,u)=>{const y=$=>$.waveIndex===a?0:$.waveIndex===-1?1:2,h=y(n),W=y(u);return h!==W?h-W:u.fame-n.fame})}function I(l,a){const n=["custom-tag"];return l.teamIndex===a?n.push(_(a)):n.push("gray-tag"),n}function w({row:l}){const a=r.selectedWaveIndex;return l.waveIndex!==a&&l.waveIndex!==-1?"disabled":l.ifsup===1?"row-support":l.ifsup===0?"row-carry":""}return(l,a)=>{const n=ce,u=Fe,y=ie;return g(),K(y,{data:v(r.playerId),style:{width:"100%"},"row-class-name":w,"empty-text":"必须先选择波次"},{default:C(()=>[b(n,{prop:"fame",label:"名望",width:"100",formatter:p}),b(n,{prop:"profession",label:"职业",width:"100"}),b(n,{prop:"buff",label:"三攻",formatter:p,width:"100"}),b(n,{prop:"waveIndex",label:"波次",width:"100",formatter:f}),b(n,{label:"队伍"},{default:C(({row:h})=>[(g(),x(T,null,D([0,1,2],W=>b(u,{key:W,class:N(I(h,W)),onClick:()=>s(h,W),effect:"dark",style:{cursor:"pointer","margin-right":"8px",color:"black"}},{default:C(()=>[A(F(c(W)),1)]),_:2},1032,["class","onClick"])),64))]),_:1})]),_:1},8,["data"])}}}),_t={class:"demo-collapse"},vt={style:{"font-size":"14px","font-weight":"bold"}},bt=S({__name:"Assignment",props:{selectedWaveIndex:{}},setup(m){const e=le(),i=ae(),d=J(),{teams:o}=V(d),{players:r}=V(e),{cube:p}=V(i),f=m,s=P([]);function c(_){var l;const v=f.selectedWaveIndex,I=p.value[_][v],w=(l=o.value[v])==null?void 0:l.color.findIndex(a=>a.filter(n=>n.id===_).length!==0);return w!==-1?"row-assigned":I===1&&w===-1?"row-carry":I===2&&w===-1?"row-support":""}return(_,v)=>{const I=ft,w=me,l=pe;return g(),x("div",_t,[b(l,{modelValue:s.value,"onUpdate:modelValue":v[0]||(v[0]=a=>s.value=a)},{default:C(()=>[(g(!0),x(T,null,D(t(r).filter(a=>!a.absent).sort((a,n)=>n.carry+n.sup-(a.carry+n.sup)),a=>(g(),K(w,{key:a.id,name:String(a.id)},{title:C(()=>[k("div",{class:N(c(a.id))},[k("span",vt,F(a.id),1)],2)]),default:C(()=>[s.value.includes(String(a.id))?(g(),K(I,{key:0,selectedWaveIndex:f.selectedWaveIndex,playerId:a.id},null,8,["selectedWaveIndex","playerId"])):ne("",!0)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])])}}}),yt=Q(bt,[["__scopeId","data-v-8291d88c"]]),ht={class:"common-layout"},gt={__name:"TeamAssignment",setup(m){const e=P(-1);function i(d){e.value=d}return(d,o)=>{const r=Me,p=Pe,f=yt,s=ze,c=mt,_=Be;return g(),x("div",ht,[b(_,{class:"container"},{default:C(()=>[b(p,{class:"aside-left"},{default:C(()=>[b(r,{onWaveClick:i})]),_:1}),b(s,{class:"main-content"},{default:C(()=>[b(f,{selectedWaveIndex:e.value},null,8,["selectedWaveIndex"])]),_:1}),b(p,{class:"aside-right"},{default:C(()=>[b(c,{selectedWaveIndex:e.value},null,8,["selectedWaveIndex"])]),_:1})]),_:1})])}}},kt=Q(gt,[["__scopeId","data-v-22e3b9ae"]]);export{kt as default};
