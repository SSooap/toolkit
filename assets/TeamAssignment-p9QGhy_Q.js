import{j as P,bw as Ce,au as H,k as le,w as Z,L as O,aX as Ee,f as pe,e as J,a3 as me,_ as oe,l as S,n as l,o,m as $,R as x,W as D,O as W,P as y,u as Ne,aK as Te,g as B,N as V,q as N,t as q,x as M,y as z,bx as We,E as $e,K as Ve,J as fe,aQ as xe,d as Q,a as ee,c as te,B as Pe,ar as j,r as R,H as ue,I as ze,D as Ae,am as Be,Q as k,aw as F,V as K,T as De,A as ve,p as Re,z as Ke,af as de,az as Me,bb as A,ba as X,s as Oe}from"./index-18NlCW2a.js";import{u as _e,c as Fe,d as Le,a as Ue,l as Y,j as be,k as ie,e as G,E as je,f as Ge,h as He,g as Qe}from"./WaveStore-BQ0GHCTp.js";import{E as he,a as ye,b as ge,c as we}from"./table-column-7BzWnrwy.js";import{I as ne,C as ae,U as se,a as qe}from"./scrollbar-WruQo-5C.js";import{E as Je}from"./index-70U8-Fg4.js";const re=Symbol("elDescriptions");var L=P({name:"ElDescriptionsCell",props:{cell:{type:Object},tag:{type:String,default:"td"},type:{type:String}},setup(){return{descriptions:pe(re,{})}},render(){var v;const r=Ce(this.cell),i=(((v=this.cell)==null?void 0:v.dirs)||[]).map(a=>{const{dir:t,arg:_,modifiers:E,value:e}=a;return[t,e,_,E]}),{border:c,direction:b}=this.descriptions,h=b==="vertical",u=()=>{var a,t,_;return((_=(t=(a=this.cell)==null?void 0:a.children)==null?void 0:t.label)==null?void 0:_.call(t))||r.label},C=()=>{var a,t,_;return(_=(t=(a=this.cell)==null?void 0:a.children)==null?void 0:t.default)==null?void 0:_.call(t)},s=r.span,g=r.rowspan,p=r.align?`is-${r.align}`:"",w=r.labelAlign?`is-${r.labelAlign}`:p,T=r.className,I=r.labelClassName,d=this.type==="label"&&(r.labelWidth||this.descriptions.labelWidth)||r.width,m={width:H(d),minWidth:H(r.minWidth)},n=le("descriptions");switch(this.type){case"label":return Z(O(this.tag,{style:m,class:[n.e("cell"),n.e("label"),n.is("bordered-label",c),n.is("vertical-label",h),w,I],colSpan:h?s:1,rowspan:h?1:g},u()),i);case"content":return Z(O(this.tag,{style:m,class:[n.e("cell"),n.e("content"),n.is("bordered-content",c),n.is("vertical-content",h),p,T],colSpan:h?s:s*2-1,rowspan:h?g*2-1:g},C()),i);default:{const a=u(),t={},_=H(r.labelWidth||this.descriptions.labelWidth);return _&&(t.width=_,t.display="inline-block"),Z(O("td",{style:m,class:[n.e("cell"),p],colSpan:s,rowspan:g},[Ee(a)?void 0:O("span",{style:t,class:[n.e("label"),I]},a),O("span",{class:[n.e("content"),T]},C())]),i)}}}});const Xe=J({row:{type:me(Array),default:()=>[]}}),Ye=P({name:"ElDescriptionsRow"}),Ze=P({...Ye,props:Xe,setup(v){const r=pe(re,{});return(i,c)=>l(r).direction==="vertical"?(o(),S(x,{key:0},[$("tr",null,[(o(!0),S(x,null,D(i.row,(b,h)=>(o(),W(l(L),{key:`tr1-${h}`,cell:b,tag:"th",type:"label"},null,8,["cell"]))),128))]),$("tr",null,[(o(!0),S(x,null,D(i.row,(b,h)=>(o(),W(l(L),{key:`tr2-${h}`,cell:b,tag:"td",type:"content"},null,8,["cell"]))),128))])],64)):(o(),S("tr",{key:1},[(o(!0),S(x,null,D(i.row,(b,h)=>(o(),S(x,{key:`tr3-${h}`},[l(r).border?(o(),S(x,{key:0},[y(l(L),{cell:b,tag:"td",type:"label"},null,8,["cell"]),y(l(L),{cell:b,tag:"td",type:"content"},null,8,["cell"])],64)):(o(),W(l(L),{key:1,cell:b,tag:"td",type:"both"},null,8,["cell"]))],64))),128))]))}});var et=oe(Ze,[["__file","descriptions-row.vue"]]);const tt=J({border:Boolean,column:{type:Number,default:3},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},size:Ne,title:{type:String,default:""},extra:{type:String,default:""},labelWidth:{type:[String,Number],default:""}}),Ie="ElDescriptionsItem",nt=P({name:"ElDescriptions"}),at=P({...nt,props:tt,setup(v){const r=v,i=le("descriptions"),c=_e(),b=Te();$e(re,r);const h=B(()=>[i.b(),i.m(c.value)]),u=(s,g,p,w=!1)=>(s.props||(s.props={}),g>p&&(s.props.span=p),w&&(s.props.span=g),s),C=()=>{if(!b.default)return[];const s=We(b.default()).filter(d=>{var m;return((m=d==null?void 0:d.type)==null?void 0:m.name)===Ie}),g=[];let p=[],w=r.column,T=0;const I=[];return s.forEach((d,m)=>{var n,a,t;const _=((n=d.props)==null?void 0:n.span)||1,E=((a=d.props)==null?void 0:a.rowspan)||1,e=g.length;if(I[e]||(I[e]=0),E>1)for(let f=1;f<E;f++)I[t=e+f]||(I[t]=0),I[e+f]++,T++;if(I[e]>0&&(w-=I[e],I[e]=0),m<s.length-1&&(T+=_>w?w:_),m===s.length-1){const f=r.column-T%r.column;p.push(u(d,f,w,!0)),g.push(p);return}_<w?(w-=_,p.push(d)):(p.push(u(d,_,w)),g.push(p),w=r.column,p=[])}),g};return(s,g)=>(o(),S("div",{class:N(l(h))},[s.title||s.extra||s.$slots.title||s.$slots.extra?(o(),S("div",{key:0,class:N(l(i).e("header"))},[$("div",{class:N(l(i).e("title"))},[q(s.$slots,"title",{},()=>[M(z(s.title),1)])],2),$("div",{class:N(l(i).e("extra"))},[q(s.$slots,"extra",{},()=>[M(z(s.extra),1)])],2)],2)):V("v-if",!0),$("div",{class:N(l(i).e("body"))},[$("table",{class:N([l(i).e("table"),l(i).is("bordered",s.border)])},[$("tbody",null,[(o(!0),S(x,null,D(C(),(p,w)=>(o(),W(et,{key:w,row:p},null,8,["row"]))),128))])],2)],2)],2))}});var st=oe(at,[["__file","description.vue"]]);const lt=J({label:{type:String,default:""},span:{type:Number,default:1},rowspan:{type:Number,default:1},width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},labelWidth:{type:[String,Number],default:""},align:{type:String,default:"left"},labelAlign:{type:String,default:""},className:{type:String,default:""},labelClassName:{type:String,default:""}}),ke=P({name:Ie,props:lt}),ot=fe(st,{DescriptionsItem:ke}),it=Ve(ke),rt=v=>["",...xe].includes(v),ct=J({modelValue:{type:[Boolean,String,Number],default:!1},disabled:Boolean,loading:Boolean,size:{type:String,validator:rt},width:{type:[String,Number],default:""},inlinePrompt:Boolean,inactiveActionIcon:{type:j},activeActionIcon:{type:j},activeIcon:{type:j},inactiveIcon:{type:j},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:me(Function)},id:String,tabindex:{type:[String,Number]},...Pe(["ariaLabel"])}),ut={[se]:v=>Q(v)||ee(v)||te(v),[ae]:v=>Q(v)||ee(v)||te(v),[ne]:v=>Q(v)||ee(v)||te(v)},Se="ElSwitch",dt=P({name:Se}),pt=P({...dt,props:ct,emits:ut,setup(v,{expose:r,emit:i}){const c=v,{formItem:b}=Fe(),h=_e(),u=le("switch"),{inputId:C}=Le(c,{formItemContext:b}),s=Ue(B(()=>c.loading)),g=R(c.modelValue!==!1),p=R(),w=R(),T=B(()=>[u.b(),u.m(h.value),u.is("disabled",s.value),u.is("checked",a.value)]),I=B(()=>[u.e("label"),u.em("label","left"),u.is("active",!a.value)]),d=B(()=>[u.e("label"),u.em("label","right"),u.is("active",a.value)]),m=B(()=>({width:H(c.width)}));ue(()=>c.modelValue,()=>{g.value=!0});const n=B(()=>g.value?c.modelValue:!1),a=B(()=>n.value===c.activeValue);[c.activeValue,c.inactiveValue].includes(n.value)||(i(se,c.inactiveValue),i(ae,c.inactiveValue),i(ne,c.inactiveValue)),ue(a,e=>{var f;p.value.checked=e,c.validateEvent&&((f=b==null?void 0:b.validate)==null||f.call(b,"change").catch(U=>ze()))});const t=()=>{const e=a.value?c.inactiveValue:c.activeValue;i(se,e),i(ae,e),i(ne,e),Ke(()=>{p.value.checked=a.value})},_=()=>{if(s.value)return;const{beforeChange:e}=c;if(!e){t();return}const f=e();[de(f),Q(f)].includes(!0)||Me(Se,"beforeChange must return type `Promise<boolean>` or `boolean`"),de(f)?f.then(ce=>{ce&&t()}).catch(ce=>{}):f&&t()},E=()=>{var e,f;(f=(e=p.value)==null?void 0:e.focus)==null||f.call(e)};return Ae(()=>{p.value.checked=a.value}),r({focus:E,checked:a}),(e,f)=>(o(),S("div",{class:N(l(T)),onClick:Re(_,["prevent"])},[$("input",{id:l(C),ref_key:"input",ref:p,class:N(l(u).e("input")),type:"checkbox",role:"switch","aria-checked":l(a),"aria-disabled":l(s),"aria-label":e.ariaLabel,name:e.name,"true-value":e.activeValue,"false-value":e.inactiveValue,disabled:l(s),tabindex:e.tabindex,onChange:t,onKeydown:Be(_,["enter"])},null,42,["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"]),!e.inlinePrompt&&(e.inactiveIcon||e.inactiveText)?(o(),S("span",{key:0,class:N(l(I))},[e.inactiveIcon?(o(),W(l(K),{key:0},{default:k(()=>[(o(),W(F(e.inactiveIcon)))]),_:1})):V("v-if",!0),!e.inactiveIcon&&e.inactiveText?(o(),S("span",{key:1,"aria-hidden":l(a)},z(e.inactiveText),9,["aria-hidden"])):V("v-if",!0)],2)):V("v-if",!0),$("span",{ref_key:"core",ref:w,class:N(l(u).e("core")),style:ve(l(m))},[e.inlinePrompt?(o(),S("div",{key:0,class:N(l(u).e("inner"))},[e.activeIcon||e.inactiveIcon?(o(),W(l(K),{key:0,class:N(l(u).is("icon"))},{default:k(()=>[(o(),W(F(l(a)?e.activeIcon:e.inactiveIcon)))]),_:1},8,["class"])):e.activeText||e.inactiveText?(o(),S("span",{key:1,class:N(l(u).is("text")),"aria-hidden":!l(a)},z(l(a)?e.activeText:e.inactiveText),11,["aria-hidden"])):V("v-if",!0)],2)):V("v-if",!0),$("div",{class:N(l(u).e("action"))},[e.loading?(o(),W(l(K),{key:0,class:N(l(u).is("loading"))},{default:k(()=>[y(l(De))]),_:1},8,["class"])):l(a)?q(e.$slots,"active-action",{key:1},()=>[e.activeActionIcon?(o(),W(l(K),{key:0},{default:k(()=>[(o(),W(F(e.activeActionIcon)))]),_:1})):V("v-if",!0)]):l(a)?V("v-if",!0):q(e.$slots,"inactive-action",{key:2},()=>[e.inactiveActionIcon?(o(),W(l(K),{key:0},{default:k(()=>[(o(),W(F(e.inactiveActionIcon)))]),_:1})):V("v-if",!0)])],2)],6),!e.inlinePrompt&&(e.activeIcon||e.activeText)?(o(),S("span",{key:1,class:N(l(d))},[e.activeIcon?(o(),W(l(K),{key:0},{default:k(()=>[(o(),W(F(e.activeIcon)))]),_:1})):V("v-if",!0),!e.activeIcon&&e.activeText?(o(),S("span",{key:1,"aria-hidden":!l(a)},z(e.activeText),9,["aria-hidden"])):V("v-if",!0)],2)):V("v-if",!0)],10,["onClick"]))}});var mt=oe(pt,[["__file","switch.vue"]]);const ft=fe(mt),vt={style:{"font-size":"16px","font-weight":"bold"}},_t=P({__name:"TeamsPreview",props:{selectedWaveIndex:Number},setup(v){const r=Y(),i=R("default"),c=v,{teams:b}=A(r),h=R(["红队","黄队","绿队"]);function u(s){return s===0?"bg-red":s===1?"bg-yellow":s===2?"bg-green":""}function C({row:s}){return s.ifsup===1?"row-support":s.ifsup===0?"row-carry":""}return(s,g)=>{const p=we,w=ge,T=ye,I=he,d=it,m=ot;return o(),W(m,{title:c.selectedWaveIndex===-1?"未选择波次":"第"+(1+c.selectedWaveIndex)+"波",direction:"vertical",column:4,size:i.value,border:""},{default:k(()=>[y(d,{label:"队伍信息"},{default:k(()=>[y(I,{modelValue:h.value,"onUpdate:modelValue":g[0]||(g[0]=n=>h.value=n)},{default:k(()=>[(o(),S(x,null,D(["红队","黄队","绿队"],(n,a)=>y(T,{key:a,name:n},{title:k(()=>[$("div",{class:N(u(a))},[$("span",vt,z(n),1)],2)]),default:k(()=>{var t;return[y(w,{data:(t=l(b)[c.selectedWaveIndex])==null?void 0:t.color[a],style:{width:"100%"},size:"small",border:"","row-class-name":C},{default:k(()=>[y(p,{prop:"id",label:"名字"}),y(p,{prop:"fame",label:"名望"}),y(p,{prop:"profession",label:"职业"})]),_:2},1032,["data"])]}),_:2},1032,["name"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["title","size"])}}}),bt=X(_t,[["__scopeId","data-v-902051f1"]]),ht=P({__name:"FilteredChars",props:{selectedWaveIndex:{},playerId:{}},setup(v){const r=Y(),i=be(),c=ie(),{teams:b}=A(r),{table:h}=A(i),{cube:u}=A(c),C=v;function s(n,a,t){return typeof t=="number"?Math.floor(t):t}function g(n,a,t){return t===-1?"赋闲":t+1}function p(n,a){const t=C.selectedWaveIndex;if(t===-1){G({message:"请选择波次",type:"error",duration:2e3});return}if(n.teamIndex===a){n.teamIndex=-1,n.waveIndex=-1;const E=b.value[t].color[a],e=E.findIndex(f=>f.uid===n.uid);e!==-1&&E.splice(e,1)}else if(b.value[t].color[a].length>=4)G({message:"队伍满员",type:"error",duration:2e3});else if(b.value[t].color.some(E=>E.some(e=>e.id===n.id&&e.uid!==n.uid)))G({message:"人员重复",type:"error",duration:2e3});else{if(n.waveIndex!==-1){G({message:`${n.id}: ${n.profession} 第${n.waveIndex+1}波->第${t+1}波`,type:"info",duration:2e3});const E=b.value[n.waveIndex].color[n.teamIndex],e=E.findIndex(f=>f.uid===n.uid);e!==-1&&E.splice(e,1)}n.teamIndex=a,n.waveIndex=t,b.value[t].color[a].push(n)}}function w(n){switch(n){case 0:return"红队";case 1:return"黄队";case 2:return"绿队";default:return""}}function T(n){switch(n){case 0:return"red-tag";case 1:return"yellow-tag";case 2:return"green-tag";default:return""}}function I(n){const a=C.selectedWaveIndex;return a===-1?[]:h.value.filter(t=>t.id===n).sort((t,_)=>{const E=U=>U.waveIndex===a?0:U.waveIndex===-1?1:2,e=E(t),f=E(_);return e!==f?e-f:_.fame-t.fame})}function d(n,a){const t=["custom-tag"];return n.teamIndex===a?t.push(T(a)):t.push("gray-tag"),t}function m({row:n}){const a=C.selectedWaveIndex;return n.waveIndex!==a&&n.waveIndex!==-1?"disabled":n.ifsup===1?"row-support":n.ifsup===0?"row-carry":""}return(n,a)=>{const t=we,_=Je,E=ge;return o(),W(E,{data:I(C.playerId),style:{width:"100%"},"row-class-name":m,"empty-text":"必须先选择波次"},{default:k(()=>[y(t,{prop:"fame",label:"名望",width:"100",formatter:s}),y(t,{prop:"profession",label:"职业",width:"100"}),y(t,{prop:"buff",label:"三攻",formatter:s,width:"100"}),y(t,{prop:"waveIndex",label:"波次",width:"100",formatter:g}),y(t,{label:"队伍"},{default:k(({row:e})=>[(o(),S(x,null,D([0,1,2],f=>y(_,{key:f,class:N(d(e,f)),onClick:()=>p(e,f),effect:"dark",style:{cursor:"pointer","margin-right":"8px",color:"black"}},{default:k(()=>[M(z(w(f)),1)]),_:2},1032,["class","onClick"])),64))]),_:1})]),_:1},8,["data"])}}}),yt={class:"demo-collapse"},gt={style:{"font-size":"14px","font-weight":"bold"}},wt=P({__name:"Assignment",props:{selectedWaveIndex:{}},setup(v){const r=be(),i=ie(),c=Y(),{teams:b}=A(c),{players:h}=A(r),{cube:u}=A(i),C=v,s=R([]);function g(p){const w=C.selectedWaveIndex,T=u.value[p][w];return T===1?"row-carry":T===2?"row-support":""}return(p,w)=>{const T=ht,I=ye,d=he;return o(),S("div",yt,[y(d,{modelValue:s.value,"onUpdate:modelValue":w[0]||(w[0]=m=>s.value=m)},{default:k(()=>[(o(!0),S(x,null,D(l(h).filter(m=>!m.absent).sort((m,n)=>n.carry+n.sup-(m.carry+n.sup)),m=>(o(),W(I,{key:m.id,name:String(m.id)},{title:k(()=>[$("div",{class:N(g(m.id))},[$("span",gt,z(m.id),1)],2)]),default:k(()=>[s.value.includes(String(m.id))?(o(),W(T,{key:0,selectedWaveIndex:C.selectedWaveIndex,playerId:m.id},null,8,["selectedWaveIndex","playerId"])):V("",!0)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])])}}}),It=X(wt,[["__scopeId","data-v-8042a371"]]),kt={class:"button-group"},St=["onClick"],Ct=P({__name:"WavesBar",emits:["wave-click"],setup(v,{emit:r}){const i=ie(),c=Y(),{waves:b}=A(i),h=R(-1),{lock:u}=A(i),C=r;function s(I){h.value=I,C("wave-click",I)}function g(){i.addnormal(),c.addnormal()}function p(){i.addhard(),c.addhard()}function w(I){i.removeWave(I),c.removeWave(I)}function T(){u&&i.syncData()}return(I,d)=>{const m=je,n=ft,a=qe;return o(),S(x,null,[$("div",kt,[y(m,{size:"large",class:"function onSwitchChange(val: any) { throw new Error('Function not implemented.') } uniform-button",onClick:d[0]||(d[0]=t=>p())},{default:k(()=>d[5]||(d[5]=[M(" + 困难")])),_:1,__:[5]}),y(m,{size:"large",class:"uniform-button",onClick:d[1]||(d[1]=t=>g())},{default:k(()=>d[6]||(d[6]=[M(" + 普通")])),_:1,__:[6]}),y(m,{size:"large",class:"uniform-button",onClick:d[2]||(d[2]=t=>w(h.value))},{default:k(()=>d[7]||(d[7]=[M("删除")])),_:1,__:[7]}),y(n,{modelValue:l(u),"onUpdate:modelValue":d[3]||(d[3]=t=>Oe(u)?u.value=t:null),"active-text":"同步并锁定","inactive-text":"编辑","active-color":"#f56c6c","inactive-color":"#67c23a",class:"my-switch",onChange:d[4]||(d[4]=t=>T())},null,8,["modelValue"])]),y(a,{"max-height":"900px"},{default:k(()=>[(o(!0),S(x,null,D(l(b),(t,_)=>(o(),S("p",{key:_,style:ve({backgroundColor:t.difficulty==="Hard"?"rgb(252, 210, 210)":"rgb(159.5, 206.5, 255)"}),class:N(["scrollbar-demo-item",{"is-selected":h.value===_}]),onClick:E=>s(_)},z(t.difficulty)+" "+z(_+1),15,St))),128))]),_:1})],64)}}}),Et=X(Ct,[["__scopeId","data-v-805b3436"]]),Nt={class:"common-layout"},Tt={__name:"TeamAssignment",setup(v){const r=R(-1);function i(c){r.value=c}return(c,b)=>{const h=Et,u=Ge,C=It,s=He,g=bt,p=Qe;return o(),S("div",Nt,[y(p,{class:"container"},{default:k(()=>[y(u,{width:"200px",class:"aside-left"},{default:k(()=>[y(h,{onWaveClick:i})]),_:1}),y(s,{class:"main-content"},{default:k(()=>[y(C,{selectedWaveIndex:r.value},null,8,["selectedWaveIndex"])]),_:1}),y(u,{width:"200px",class:"aside-right"},{default:k(()=>[y(g,{selectedWaveIndex:r.value},null,8,["selectedWaveIndex"])]),_:1})]),_:1})])}}},zt=X(Tt,[["__scopeId","data-v-ecd2e61c"]]);export{zt as default};
