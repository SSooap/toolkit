import{d as j,a9 as be,f as Y,g as P,u as Z,h as x,p as S,A as N,q as o,v as W,r as V,y as K,s as C,t as a,B as w,Q as g,m as fe,P as le,E as D,x as X,aa as Ne,D as ce,ab as $e,ac as Q,ad as ne,ae as O,H as We,W as he,e as ye,L as z,M,af as Ve,ag as Pe,ah as ze,a3 as Be,a8 as F,z as B,ai as xe,aj as J,o as ae,ak as se,al as Ae,am as q,K as R,a0 as ve,a1 as De,an as Me,O as Re,C as L,ao as Fe,ap as Ke,aq as _e,F as Oe,ar as A,_ as ee,as as Le}from"./index-5zBs-h12.js";import{r as ue,u as Ue,l as te,j as ge,k as de,E as H,p as je,q as Ge,o as qe}from"./WaveStore-B_0CipcP.js";import{I as oe,C as ie,U as re,u as He,a as Qe,E as Ie,b as we,c as ke,d as Ce,e as Je,f as Xe}from"./button-7q23CK7n.js";const Ye=j({type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:String,size:{type:String,values:be},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),Ze={close:f=>f instanceof MouseEvent,click:f=>f instanceof MouseEvent},et=P({name:"ElTag"}),tt=P({...et,props:Ye,emits:Ze,setup(f,{emit:c}){const u=f,p=ue(),r=Z("tag"),_=x(()=>{const{type:i,hit:d,effect:b,closable:E,round:k}=u;return[r.b(),r.is("closable",E),r.m(i||"primary"),r.m(p.value),r.m(b),r.is("hit",d),r.is("round",k)]}),m=i=>{c("close",i)},T=i=>{c("click",i)},l=i=>{var d,b,E;(E=(b=(d=i==null?void 0:i.component)==null?void 0:d.subTree)==null?void 0:b.component)!=null&&E.bum&&(i.component.subTree.component.bum=null)};return(i,d)=>i.disableTransitions?(o(),S("span",{key:0,class:C(a(_)),style:X({backgroundColor:i.color}),onClick:T},[W("span",{class:C(a(r).e("content"))},[K(i.$slots,"default")],2),i.closable?(o(),N(a(D),{key:0,class:C(a(r).e("close")),onClick:le(m,["stop"])},{default:w(()=>[g(a(fe))]),_:1},8,["class","onClick"])):V("v-if",!0)],6)):(o(),N(Ne,{key:1,name:`${a(r).namespace.value}-zoom-in-center`,appear:"",onVnodeMounted:l},{default:w(()=>[W("span",{class:C(a(_)),style:X({backgroundColor:i.color}),onClick:T},[W("span",{class:C(a(r).e("content"))},[K(i.$slots,"default")],2),i.closable?(o(),N(a(D),{key:0,class:C(a(r).e("close")),onClick:le(m,["stop"])},{default:w(()=>[g(a(fe))]),_:1},8,["class","onClick"])):V("v-if",!0)],6)]),_:3},8,["name"]))}});var nt=Y(tt,[["__file","tag.vue"]]);const at=ce(nt),pe=Symbol("elDescriptions");var U=P({name:"ElDescriptionsCell",props:{cell:{type:Object},tag:{type:String,default:"td"},type:{type:String}},setup(){return{descriptions:he(pe,{})}},render(){var f;const c=$e(this.cell),u=(((f=this.cell)==null?void 0:f.dirs)||[]).map(s=>{const{dir:t,arg:I,modifiers:$,value:e}=s;return[t,e,I,$]}),{border:p,direction:r}=this.descriptions,_=r==="vertical",m=()=>{var s,t,I;return((I=(t=(s=this.cell)==null?void 0:s.children)==null?void 0:t.label)==null?void 0:I.call(t))||c.label},T=()=>{var s,t,I;return(I=(t=(s=this.cell)==null?void 0:s.children)==null?void 0:t.default)==null?void 0:I.call(t)},l=c.span,i=c.rowspan,d=c.align?`is-${c.align}`:"",b=c.labelAlign?`is-${c.labelAlign}`:d,E=c.className,k=c.labelClassName,v=this.type==="label"&&(c.labelWidth||this.descriptions.labelWidth)||c.width,h={width:Q(v),minWidth:Q(c.minWidth)},n=Z("descriptions");switch(this.type){case"label":return ne(O(this.tag,{style:h,class:[n.e("cell"),n.e("label"),n.is("bordered-label",p),n.is("vertical-label",_),b,k],colSpan:_?l:1,rowspan:_?1:i},m()),u);case"content":return ne(O(this.tag,{style:h,class:[n.e("cell"),n.e("content"),n.is("bordered-content",p),n.is("vertical-content",_),d,E],colSpan:_?l:l*2-1,rowspan:_?i*2-1:i},T()),u);default:{const s=m(),t={},I=Q(c.labelWidth||this.descriptions.labelWidth);return I&&(t.width=I,t.display="inline-block"),ne(O("td",{style:h,class:[n.e("cell"),d],colSpan:l,rowspan:i},[We(s)?void 0:O("span",{style:t,class:[n.e("label"),k]},s),O("span",{class:[n.e("content"),E]},T())]),u)}}}});const st=j({row:{type:ye(Array),default:()=>[]}}),lt=P({name:"ElDescriptionsRow"}),ot=P({...lt,props:st,setup(f){const c=he(pe,{});return(u,p)=>a(c).direction==="vertical"?(o(),S(z,{key:0},[W("tr",null,[(o(!0),S(z,null,M(u.row,(r,_)=>(o(),N(a(U),{key:`tr1-${_}`,cell:r,tag:"th",type:"label"},null,8,["cell"]))),128))]),W("tr",null,[(o(!0),S(z,null,M(u.row,(r,_)=>(o(),N(a(U),{key:`tr2-${_}`,cell:r,tag:"td",type:"content"},null,8,["cell"]))),128))])],64)):(o(),S("tr",{key:1},[(o(!0),S(z,null,M(u.row,(r,_)=>(o(),S(z,{key:`tr3-${_}`},[a(c).border?(o(),S(z,{key:0},[g(a(U),{cell:r,tag:"td",type:"label"},null,8,["cell"]),g(a(U),{cell:r,tag:"td",type:"content"},null,8,["cell"])],64)):(o(),N(a(U),{key:1,cell:r,tag:"td",type:"both"},null,8,["cell"]))],64))),128))]))}});var it=Y(ot,[["__file","descriptions-row.vue"]]);const rt=j({border:Boolean,column:{type:Number,default:3},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},size:Ve,title:{type:String,default:""},extra:{type:String,default:""},labelWidth:{type:[String,Number],default:""}}),Se="ElDescriptionsItem",ct=P({name:"ElDescriptions"}),ut=P({...ct,props:rt,setup(f){const c=f,u=Z("descriptions"),p=ue(),r=Pe();Be(pe,c);const _=x(()=>[u.b(),u.m(p.value)]),m=(l,i,d,b=!1)=>(l.props||(l.props={}),i>d&&(l.props.span=d),b&&(l.props.span=i),l),T=()=>{if(!r.default)return[];const l=ze(r.default()).filter(v=>{var h;return((h=v==null?void 0:v.type)==null?void 0:h.name)===Se}),i=[];let d=[],b=c.column,E=0;const k=[];return l.forEach((v,h)=>{var n,s,t;const I=((n=v.props)==null?void 0:n.span)||1,$=((s=v.props)==null?void 0:s.rowspan)||1,e=i.length;if(k[e]||(k[e]=0),$>1)for(let y=1;y<$;y++)k[t=e+y]||(k[t]=0),k[e+y]++,E++;if(k[e]>0&&(b-=k[e],k[e]=0),h<l.length-1&&(E+=I>b?b:I),h===l.length-1){const y=c.column-E%c.column;d.push(m(v,y,b,!0)),i.push(d);return}I<b?(b-=I,d.push(v)):(d.push(m(v,I,b)),i.push(d),b=c.column,d=[])}),i};return(l,i)=>(o(),S("div",{class:C(a(_))},[l.title||l.extra||l.$slots.title||l.$slots.extra?(o(),S("div",{key:0,class:C(a(u).e("header"))},[W("div",{class:C(a(u).e("title"))},[K(l.$slots,"title",{},()=>[F(B(l.title),1)])],2),W("div",{class:C(a(u).e("extra"))},[K(l.$slots,"extra",{},()=>[F(B(l.extra),1)])],2)],2)):V("v-if",!0),W("div",{class:C(a(u).e("body"))},[W("table",{class:C([a(u).e("table"),a(u).is("bordered",l.border)])},[W("tbody",null,[(o(!0),S(z,null,M(T(),(d,b)=>(o(),N(it,{key:b,row:d},null,8,["row"]))),128))])],2)],2)],2))}});var dt=Y(ut,[["__file","description.vue"]]);const pt=j({label:{type:String,default:""},span:{type:Number,default:1},rowspan:{type:Number,default:1},width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},labelWidth:{type:[String,Number],default:""},align:{type:String,default:"left"},labelAlign:{type:String,default:""},className:{type:String,default:""},labelClassName:{type:String,default:""}}),Ee=P({name:Se,props:pt}),mt=ce(dt,{DescriptionsItem:Ee}),ft=xe(Ee),vt=f=>["",...be].includes(f),_t=j({modelValue:{type:[Boolean,String,Number],default:!1},disabled:Boolean,loading:Boolean,size:{type:String,validator:vt},width:{type:[String,Number],default:""},inlinePrompt:Boolean,inactiveActionIcon:{type:q},activeActionIcon:{type:q},activeIcon:{type:q},inactiveIcon:{type:q},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:ye(Function)},id:String,tabindex:{type:[String,Number]},...Ae(["ariaLabel"])}),bt={[re]:f=>J(f)||ae(f)||se(f),[ie]:f=>J(f)||ae(f)||se(f),[oe]:f=>J(f)||ae(f)||se(f)},Te="ElSwitch",ht=P({name:Te}),yt=P({...ht,props:_t,emits:bt,setup(f,{expose:c,emit:u}){const p=f,{formItem:r}=He(),_=ue(),m=Z("switch"),{inputId:T}=Qe(p,{formItemContext:r}),l=Ue(x(()=>p.loading)),i=R(p.modelValue!==!1),d=R(),b=R(),E=x(()=>[m.b(),m.m(_.value),m.is("disabled",l.value),m.is("checked",s.value)]),k=x(()=>[m.e("label"),m.em("label","left"),m.is("active",!s.value)]),v=x(()=>[m.e("label"),m.em("label","right"),m.is("active",s.value)]),h=x(()=>({width:Q(p.width)}));ve(()=>p.modelValue,()=>{i.value=!0});const n=x(()=>i.value?p.modelValue:!1),s=x(()=>n.value===p.activeValue);[p.activeValue,p.inactiveValue].includes(n.value)||(u(re,p.inactiveValue),u(ie,p.inactiveValue),u(oe,p.inactiveValue)),ve(s,e=>{var y;d.value.checked=e,p.validateEvent&&((y=r==null?void 0:r.validate)==null||y.call(r,"change").catch(G=>De()))});const t=()=>{const e=s.value?p.inactiveValue:p.activeValue;u(re,e),u(ie,e),u(oe,e),Ke(()=>{d.value.checked=s.value})},I=()=>{if(l.value)return;const{beforeChange:e}=p;if(!e){t();return}const y=e();[_e(y),J(y)].includes(!0)||Oe(Te,"beforeChange must return type `Promise<boolean>` or `boolean`"),_e(y)?y.then(me=>{me&&t()}).catch(me=>{}):y&&t()},$=()=>{var e,y;(y=(e=d.value)==null?void 0:e.focus)==null||y.call(e)};return Me(()=>{d.value.checked=s.value}),c({focus:$,checked:s}),(e,y)=>(o(),S("div",{class:C(a(E)),onClick:le(I,["prevent"])},[W("input",{id:a(T),ref_key:"input",ref:d,class:C(a(m).e("input")),type:"checkbox",role:"switch","aria-checked":a(s),"aria-disabled":a(l),"aria-label":e.ariaLabel,name:e.name,"true-value":e.activeValue,"false-value":e.inactiveValue,disabled:a(l),tabindex:e.tabindex,onChange:t,onKeydown:Re(I,["enter"])},null,42,["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"]),!e.inlinePrompt&&(e.inactiveIcon||e.inactiveText)?(o(),S("span",{key:0,class:C(a(k))},[e.inactiveIcon?(o(),N(a(D),{key:0},{default:w(()=>[(o(),N(L(e.inactiveIcon)))]),_:1})):V("v-if",!0),!e.inactiveIcon&&e.inactiveText?(o(),S("span",{key:1,"aria-hidden":a(s)},B(e.inactiveText),9,["aria-hidden"])):V("v-if",!0)],2)):V("v-if",!0),W("span",{ref_key:"core",ref:b,class:C(a(m).e("core")),style:X(a(h))},[e.inlinePrompt?(o(),S("div",{key:0,class:C(a(m).e("inner"))},[e.activeIcon||e.inactiveIcon?(o(),N(a(D),{key:0,class:C(a(m).is("icon"))},{default:w(()=>[(o(),N(L(a(s)?e.activeIcon:e.inactiveIcon)))]),_:1},8,["class"])):e.activeText||e.inactiveText?(o(),S("span",{key:1,class:C(a(m).is("text")),"aria-hidden":!a(s)},B(a(s)?e.activeText:e.inactiveText),11,["aria-hidden"])):V("v-if",!0)],2)):V("v-if",!0),W("div",{class:C(a(m).e("action"))},[e.loading?(o(),N(a(D),{key:0,class:C(a(m).is("loading"))},{default:w(()=>[g(a(Fe))]),_:1},8,["class"])):a(s)?K(e.$slots,"active-action",{key:1},()=>[e.activeActionIcon?(o(),N(a(D),{key:0},{default:w(()=>[(o(),N(L(e.activeActionIcon)))]),_:1})):V("v-if",!0)]):a(s)?V("v-if",!0):K(e.$slots,"inactive-action",{key:2},()=>[e.inactiveActionIcon?(o(),N(a(D),{key:0},{default:w(()=>[(o(),N(L(e.inactiveActionIcon)))]),_:1})):V("v-if",!0)])],2)],6),!e.inlinePrompt&&(e.activeIcon||e.activeText)?(o(),S("span",{key:1,class:C(a(v))},[e.activeIcon?(o(),N(a(D),{key:0},{default:w(()=>[(o(),N(L(e.activeIcon)))]),_:1})):V("v-if",!0),!e.activeIcon&&e.activeText?(o(),S("span",{key:1,"aria-hidden":!a(s)},B(e.activeText),9,["aria-hidden"])):V("v-if",!0)],2)):V("v-if",!0)],10,["onClick"]))}});var gt=Y(yt,[["__file","switch.vue"]]);const It=ce(gt),wt={style:{"font-size":"16px","font-weight":"bold"}},kt=P({__name:"TeamsPreview",props:{selectedWaveIndex:Number},setup(f){const c=te(),u=R("default"),p=f,{teams:r}=A(c),_=R(["红队","黄队","绿队"]);function m(l){return l===0?"bg-red":l===1?"bg-yellow":l===2?"bg-green":""}function T({row:l}){return l.ifsup===1?"row-support":l.ifsup===0?"row-carry":""}return(l,i)=>{const d=Ce,b=ke,E=we,k=Ie,v=ft,h=mt;return o(),N(h,{title:p.selectedWaveIndex===-1?"未选择波次":"第"+(1+p.selectedWaveIndex)+"波",direction:"vertical",column:4,size:u.value,border:""},{default:w(()=>[g(v,{label:"队伍信息"},{default:w(()=>[g(k,{modelValue:_.value,"onUpdate:modelValue":i[0]||(i[0]=n=>_.value=n)},{default:w(()=>[(o(),S(z,null,M(["红队","黄队","绿队"],(n,s)=>g(E,{key:s,name:n},{title:w(()=>[W("div",{class:C(m(s))},[W("span",wt,B(n),1)],2)]),default:w(()=>{var t;return[g(b,{data:(t=a(r)[p.selectedWaveIndex])==null?void 0:t.color[s],style:{width:"100%"},size:"small",border:"","row-class-name":T},{default:w(()=>[g(d,{prop:"id",label:"名字"}),g(d,{prop:"fame",label:"名望"}),g(d,{prop:"profession",label:"职业"})]),_:2},1032,["data"])]}),_:2},1032,["name"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["title","size"])}}}),Ct=ee(kt,[["__scopeId","data-v-902051f1"]]),St=P({__name:"FilteredChars",props:{selectedWaveIndex:{},playerId:{}},setup(f){const c=te(),u=ge(),p=de(),{teams:r}=A(c),{table:_}=A(u),{cube:m}=A(p),T=f;function l(n,s,t){return typeof t=="number"?Math.floor(t):t}function i(n,s,t){return t===-1?"赋闲":t+1}function d(n,s){const t=T.selectedWaveIndex;if(t===-1){H({message:"请选择波次",type:"error",duration:2e3});return}if(n.teamIndex===s){n.teamIndex=-1,n.waveIndex=-1;const $=r.value[t].color[s],e=$.findIndex(y=>y.uid===n.uid);e!==-1&&$.splice(e,1)}else if(r.value[t].color[s].length>=4)H({message:"队伍满员",type:"error",duration:2e3});else if(r.value[t].color.some($=>$.some(e=>e.id===n.id&&e.uid!==n.uid)))H({message:"人员重复",type:"error",duration:2e3});else{if(n.waveIndex!==-1){H({message:`${n.id}: ${n.profession} 第${n.waveIndex+1}波->第${t+1}波`,type:"info",duration:2e3});const $=r.value[n.waveIndex].color[n.teamIndex],e=$.findIndex(y=>y.uid===n.uid);e!==-1&&$.splice(e,1)}n.teamIndex=s,n.waveIndex=t,r.value[t].color[s].push(n)}}function b(n){switch(n){case 0:return"红队";case 1:return"黄队";case 2:return"绿队";default:return""}}function E(n){switch(n){case 0:return"red-tag";case 1:return"yellow-tag";case 2:return"green-tag";default:return""}}function k(n){const s=T.selectedWaveIndex;return s===-1?[]:_.value.filter(t=>t.id===n).sort((t,I)=>{const $=G=>G.waveIndex===s?0:G.waveIndex===-1?1:2,e=$(t),y=$(I);return e!==y?e-y:I.fame-t.fame})}function v(n,s){const t=["custom-tag"];return n.teamIndex===s?t.push(E(s)):t.push("gray-tag"),t}function h({row:n}){const s=T.selectedWaveIndex;return n.waveIndex!==s&&n.waveIndex!==-1?"disabled":n.ifsup===1?"row-support":n.ifsup===0?"row-carry":""}return(n,s)=>{const t=Ce,I=at,$=ke;return o(),N($,{data:k(T.playerId),style:{width:"100%"},"row-class-name":h,"empty-text":"必须先选择波次"},{default:w(()=>[g(t,{prop:"fame",label:"名望",width:"100",formatter:l}),g(t,{prop:"profession",label:"职业",width:"100"}),g(t,{prop:"buff",label:"三攻",formatter:l,width:"100"}),g(t,{prop:"waveIndex",label:"波次",width:"100",formatter:i}),g(t,{label:"队伍"},{default:w(({row:e})=>[(o(),S(z,null,M([0,1,2],y=>g(I,{key:y,class:C(v(e,y)),onClick:()=>d(e,y),effect:"dark",style:{cursor:"pointer","margin-right":"8px",color:"black"}},{default:w(()=>[F(B(b(y)),1)]),_:2},1032,["class","onClick"])),64))]),_:1})]),_:1},8,["data"])}}}),Et={class:"demo-collapse"},Tt={style:{"font-size":"14px","font-weight":"bold"}},Nt=P({__name:"Assignment",props:{selectedWaveIndex:{}},setup(f){const c=ge(),u=de(),p=te(),{teams:r}=A(p),{players:_}=A(c),{cube:m}=A(u),T=f,l=R([]);function i(d){const b=T.selectedWaveIndex,E=m.value[d][b];return E===1?"row-carry":E===2?"row-support":""}return(d,b)=>{const E=St,k=we,v=Ie;return o(),S("div",Et,[g(v,{modelValue:l.value,"onUpdate:modelValue":b[0]||(b[0]=h=>l.value=h)},{default:w(()=>[(o(!0),S(z,null,M(a(_).filter(h=>!h.absent).sort((h,n)=>n.carry+n.sup-(h.carry+n.sup)),h=>(o(),N(k,{key:h.id,name:String(h.id)},{title:w(()=>[W("div",{class:C(i(h.id))},[W("span",Tt,B(h.id),1)],2)]),default:w(()=>[l.value.includes(String(h.id))?(o(),N(E,{key:0,selectedWaveIndex:T.selectedWaveIndex,playerId:h.id},null,8,["selectedWaveIndex","playerId"])):V("",!0)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])])}}}),$t=ee(Nt,[["__scopeId","data-v-8042a371"]]),Wt={class:"button-group"},Vt=["onClick"],Pt=P({__name:"WavesBar",emits:["wave-click"],setup(f,{emit:c}){const u=de(),p=te(),{waves:r}=A(u),_=R(-1),{lock:m}=A(u),T=c;function l(k){_.value=k,T("wave-click",k)}function i(){u.addnormal(),p.addnormal()}function d(){u.addhard(),p.addhard()}function b(k){u.removeWave(k),p.removeWave(k)}function E(){m&&u.syncData()}return(k,v)=>{const h=Je,n=It,s=Xe;return o(),S(z,null,[W("div",Wt,[g(h,{size:"large",class:"function onSwitchChange(val: any) { throw new Error('Function not implemented.') } uniform-button",onClick:v[0]||(v[0]=t=>d())},{default:w(()=>v[5]||(v[5]=[F(" + 困难")])),_:1,__:[5]}),g(h,{size:"large",class:"uniform-button",onClick:v[1]||(v[1]=t=>i())},{default:w(()=>v[6]||(v[6]=[F(" + 普通")])),_:1,__:[6]}),g(h,{size:"large",class:"uniform-button",onClick:v[2]||(v[2]=t=>b(_.value))},{default:w(()=>v[7]||(v[7]=[F("删除")])),_:1,__:[7]}),g(n,{modelValue:a(m),"onUpdate:modelValue":v[3]||(v[3]=t=>Le(m)?m.value=t:null),"active-text":"同步并锁定","inactive-text":"编辑","active-color":"#f56c6c","inactive-color":"#67c23a",class:"my-switch",onChange:v[4]||(v[4]=t=>E())},null,8,["modelValue"])]),g(s,{"max-height":"900px"},{default:w(()=>[(o(!0),S(z,null,M(a(r),(t,I)=>(o(),S("p",{key:I,style:X({backgroundColor:t.difficulty==="Hard"?"rgb(252, 210, 210)":"rgb(159.5, 206.5, 255)"}),class:C(["scrollbar-demo-item",{"is-selected":_.value===I}]),onClick:$=>l(I)},B(t.difficulty)+" "+B(I+1),15,Vt))),128))]),_:1})],64)}}}),zt=ee(Pt,[["__scopeId","data-v-fb8df972"]]),Bt={class:"common-layout"},xt={__name:"TeamAssignment",setup(f){const c=R(-1);function u(p){c.value=p}return(p,r)=>{const _=zt,m=je,T=$t,l=Ge,i=Ct,d=qe;return o(),S("div",Bt,[g(d,{class:"container"},{default:w(()=>[g(m,{width:"200px",class:"aside-left"},{default:w(()=>[g(_,{onWaveClick:u})]),_:1}),g(l,{class:"main-content"},{default:w(()=>[g(T,{selectedWaveIndex:c.value},null,8,["selectedWaveIndex"])]),_:1}),g(m,{width:"200px",class:"aside-right"},{default:w(()=>[g(i,{selectedWaveIndex:c.value},null,8,["selectedWaveIndex"])]),_:1})]),_:1})])}}},Rt=ee(xt,[["__scopeId","data-v-ecd2e61c"]]);export{Rt as default};
